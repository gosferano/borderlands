---
import type { CollectionEntry } from 'astro:content';
import StarRating from './StarRating.astro';

interface Props {
  build: CollectionEntry<'builds'>;
}

const { build } = Astro.props;

const data = build.data;
const url = `/borderlands/builds/${build.id}/`;

const renderStars = (count: number, max = 4) => Array.from({ length: max }, (_, i) => i < count);
---

<a
  href={url}
  class="block overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm transition hover:shadow-md dark:border-gray-700 dark:bg-gray-800"
>
  {
    data.heroImage && (
      <img
        src={data.heroImage.src ?? data.heroImage}
        alt={data.title}
        class="h-48 w-full object-cover"
      />
    )
  }

  <div class="space-y-3 p-4">
    <h2 class="text-xl font-semibold text-gray-800 dark:text-gray-100">{data.title}</h2>

    <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400">
      <span><strong>Published:</strong> {new Date(data.pubDate).toLocaleDateString()}</span>
      <span><strong>Updated:</strong> {new Date(data.updatedDate).toLocaleDateString()}</span>
    </div>

    <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400">
      <span><strong>Creator:</strong> {data.creator}</span>
      <span><strong>Reviewer:</strong> {data.reviewer}</span>
    </div>

    <div class="mt-2 flex flex-col gap-1">
      <div class="flex items-center justify-between">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Mobbing:</span>
        <div class="flex space-x-1">
          <StarRating rating={data.mobbingRating} max={4} />
        </div>
      </div>

      <div class="flex items-center justify-between">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Bossing:</span>
        <div class="flex space-x-1">
          <StarRating rating={data.bossingRating} max={4} />
        </div>
      </div>
    </div>
  </div>
</a>
